Search.setIndex({docnames:["autograd_grad_sample","compute_dp_sgd_privacy","dp_multihead_attention","index","layers","per_sample_gradient_clip","per_sample_gradients","privacy_analysis","privacy_engine","scripts","stats","supported_layers_grad_samplers","tensor_utils","utils"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["autograd_grad_sample.rst","compute_dp_sgd_privacy.rst","dp_multihead_attention.rst","index.rst","layers.rst","per_sample_gradient_clip.rst","per_sample_gradients.rst","privacy_analysis.rst","privacy_engine.rst","scripts.rst","stats.rst","supported_layers_grad_samplers.rst","tensor_utils.rst","utils.rst"],objects:{"opacus.autograd_grad_sample":{add_hooks:[6,1,1,""],disable_hooks:[6,1,1,""],enable_hooks:[6,1,1,""],is_supported:[6,1,1,""],remove_hooks:[6,1,1,""]},"opacus.layers":{dp_multihead_attention:[2,0,0,"-"]},"opacus.layers.dp_multihead_attention":{DPMultiheadAttention:[2,2,1,""],SequenceBias:[2,2,1,""]},"opacus.layers.dp_multihead_attention.DPMultiheadAttention":{forward:[2,3,1,""],load_state_dict:[2,3,1,""]},"opacus.layers.dp_multihead_attention.SequenceBias":{bias:[2,4,1,""],forward:[2,3,1,""]},"opacus.per_sample_gradient_clip":{PerSampleGradientClipper:[5,2,1,""]},"opacus.per_sample_gradient_clip.PerSampleGradientClipper":{clip_and_accumulate:[5,3,1,""],close:[5,3,1,""],pre_step:[5,3,1,""],set_on_batch_clip_func:[5,3,1,""]},"opacus.privacy_analysis":{compute_rdp:[7,1,1,""],get_privacy_spent:[7,1,1,""]},"opacus.privacy_engine":{PrivacyEngine:[8,2,1,""]},"opacus.privacy_engine.PrivacyEngine":{attach:[8,3,1,""],detach:[8,3,1,""],get_privacy_spent:[8,3,1,""],step:[8,3,1,""],to:[8,3,1,""],virtual_step:[8,3,1,""]},"opacus.scripts":{compute_dp_sgd_privacy:[1,0,0,"-"]},"opacus.scripts.compute_dp_sgd_privacy":{compute_dp_sgd_privacy:[1,1,1,""]},"opacus.supported_layers_grad_samplers":{_supported_layers_grad_samplers:[11,4,1,""]},"opacus.utils":{stats:[10,0,0,"-"],tensor_utils:[12,0,0,"-"]},"opacus.utils.stats":{Stat:[10,2,1,""],StatType:[10,2,1,""],add:[10,1,1,""],clear:[10,1,1,""],remove:[10,1,1,""],reset:[10,1,1,""],set_global_summary_writer:[10,1,1,""],update:[10,1,1,""]},"opacus.utils.stats.Stat":{log:[10,3,1,""],reset:[10,3,1,""]},"opacus.utils.tensor_utils":{calc_sample_norms:[12,1,1,""],sum_over_all_but_batch_and_last_n:[12,1,1,""]},opacus:{autograd_grad_sample:[6,0,0,"-"],per_sample_gradient_clip:[5,0,0,"-"],privacy_analysis:[7,0,0,"-"],privacy_engine:[8,0,0,"-"],supported_layers_grad_samplers:[11,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"],"4":["py","attribute","Python attribute"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method","4":"py:attribute"},terms:{"0618":12,"0th":12,"100":1,"128":8,"2048":8,"256":1,"5117":12,"598":[0,6],"60000":1,"class":[2,5,8,10],"default":[0,1,6,8,10],"enum":10,"final":5,"float":[1,7,8,10],"function":[0,1,2,5,6,7,8,10,12],"import":8,"int":[1,2,5,7,8,12],"return":[0,1,5,6,7,8,12],"true":[0,1,2,5,6,8,12],"while":[2,8],For:[2,8],Its:[7,10],That:8,The:[0,1,5,6,7,8,10],Then:8,Use:10,Used:8,Useful:10,_supported_layers_grad_sampl:[6,11],about:10,acc1:10,acc1_valu:10,account:[1,8],accumul:[5,8,10],accuraci:10,achiev:5,across:10,activ:[0,6,10,11],add:[0,2,6,8,10],add_bias_kv:2,add_hook:[0,6],add_scalar:10,add_zero_attn:2,added:[0,1,5,6,7,8,10],adding:[5,10],addit:7,advantag:8,affect:[5,10],after:[5,8],afterward:2,aggreg:[0,5,6,8,12],all:[0,2,5,6,7,8,10,12],alloc:8,allow:[2,10],alpha:[1,7,8],alreadi:10,altern:8,although:2,alwai:[0,5,6],amount:8,analysi:[1,3],ani:[8,10],anoth:10,appear:[0,5,6],appli:[1,5,7],arbitrari:8,arg:10,argument:8,around:10,arrai:7,assum:12,attach:[5,8,10],attn_mask:2,attribut:8,autograd:3,autograd_grad_sampl:[0,6],automat:8,avail:[0,6],averag:[5,8,10],avg:10,b_sz:5,back:5,backprop:[0,6],backpropag:[5,6,11],backward:[0,5,6,8],base:[0,1,2,6,7],batch:[0,1,2,5,6,8,12],batch_first:[0,5,6,8],batch_siz:[0,1,5,6,8],been:[0,6],befor:[5,8],behaviour:[0,6],being:[0,6,12],benefici:8,best:8,bia:2,blob:[1,7],block:2,bool:[0,1,5,6,8,12],both:2,bound:5,budget:[1,8],build:2,busi:8,calc_sample_norm:12,calcul:[2,6,11,12],call:[1,2,5,8,10],callabl:[5,6,11],can:[0,1,5,6,7,8,10],cannot:5,captur:[0,6],care:2,cat:5,check:[0,6],clear:10,clip:[3,8,10],clip_and_accumul:5,clipper:[5,8],close:5,code:[1,7,10],collect:[5,6,10,11],com:[0,1,6,7],come:8,command:1,common:10,compon:8,comput:[0,2,3,5,6,7,8,9],compute_accuraci:10,compute_dp_sgd_privaci:1,compute_rdp:7,constant:8,constraint:5,consum:8,consumpt:8,contain:8,contrast:2,contribut:[0,6],convert:8,correct:[0,6],correspond:[0,5,6,8,11],cost:8,could:[5,10],cover:10,cpu:8,creat:10,criterion:8,cuda:8,current:[0,2,6,10],cybertronai:[0,6],dataload:8,dataset:[1,8],defin:[2,5,8],delta:[1,7,8],depend:7,detach:8,determin:[0,6],deviat:[1,7,8],devic:8,dict:[6,10,11],dictionari:10,differ:5,differenti:[5,7,8,10],dim:12,dimens:[0,2,5,6,8,12],directli:[8,10],disabl:[0,6],disable_hook:[0,6],discard:8,displai:10,doc:8,doe:8,don:10,downstream:[6,11],dp_multihead_attent:2,dpmultiheadattent:[3,4],dropout:2,dtype:7,dure:[0,6,10],each:[5,8,12],easier:10,effect:8,effici:8,element:2,els:[0,5,6,8],embed:2,embed_dim:2,enabl:[0,1,6,8],enable_hook:[0,6],encapsul:5,end:2,engin:[2,3,5],ensur:[5,8],enter:1,entir:5,enumer:8,epoch:[1,8],epsilon:[1,7,8,10],equal:7,eras:8,estim:1,etc:10,everi:[2,8,10],evolv:10,exampl:[0,1,2,5,6,7,8,10,12],except:12,exclud:12,exist:10,experi:8,extern:10,fals:[0,2,5,6,8],far:8,field:[5,8],file:10,find:1,first:[0,5,6,8,12],fit:8,flag:[0,5,6,8,12],flat:[5,12],flatten:5,follow:[5,8,10],former:2,forward:[0,2,6],frequenc:10,friendli:2,from:[0,1,2,5,6,8,10,11,12],full:2,gather:10,gaussian:[1,5,7,8],gener:[8,10,12],get:[5,8,10],get_privacy_sp:[7,8],github:[0,1,6,7],given:[6,7,10,11,12],global:[0,6,10],googl:[1,7],gpu:8,grad:[3,5],grad_norm_typ:8,grad_sampl:[0,5,6,8],gradient:[0,2,3,8,10,11],greater:[1,5,8],guarante:[7,8],hack:[0,6],handl:8,has:[0,2,5,6,8],have:[2,5,7,8,10],here:[5,7,8],higher:8,hook:[0,2,5,6],how:[8,10],howev:[0,6],html:[2,8],http:[0,1,2,6,7,8],idea:8,identifi:10,ignor:[2,12],imagin:8,implement:[0,2,6,10],impli:[0,5,6],index:3,indic:[0,5,6,8],inf:7,init:8,initi:[2,8],inject:8,input:[0,1,2,5,6,8,11,12],insid:[8,10],insight:10,instal:[0,6],instanc:[2,8,10],instanti:[8,10],instead:[2,10],interfac:10,intern:[2,10],involv:5,is_support:[0,6],issu:[0,6],iter:[1,7,8,10,12],its:5,itself:8,just:[5,8,10],kdim:2,keep:[5,8,12],kei:2,key_padding_mask:2,known:[0,6],larg:8,larger:8,last:[8,12],later:[8,10],latter:2,layer:[0,2,3,5,8,12],learnabl:2,length:[2,7,12],leverag:2,librari:[0,6],like:10,line:[1,8,10],linear:8,list:[1,7,8,12],load:2,load_state_dict:2,locat:10,log:10,logit:8,loss:[0,1,5,6,8,10],loss_reduct:[0,5,6,8],main:[8,10],mainli:1,make:5,map:[6,11],master:[1,7],match:5,max_grad_norm:8,max_ord:7,maximum:[5,8],mean:[0,5,6,8,10],mechan:[1,5,7],memori:8,meter:10,method:[6,8,11],metric:10,might:8,mini:[5,8],misc_set:8,model:[0,1,5,6,8],modul:[0,2,3,5,6,8,11],monitor:10,monkeypatch:8,most:5,move:8,multiheadattent:2,multipl:7,n_dim:12,n_total_param:5,name:[6,10,11,12],named_param:12,named_valu:10,namespac:10,need:[0,2,6,8,10],need_weight:2,never:8,next:8,nois:[1,5,7,8,10],noise_multipli:[1,7,8],none:[2,5,8,10],norm:[5,8,10,12],norm_clipp:5,normal:5,normclipp:5,note:[0,5,6,7,8],now:[0,6,8],num_head:2,number:[1,7,8,12],nxb:8,object:[5,8,10],observ:10,off:8,on_batch_clip_func:5,onc:10,one:[2,10],ones:[10,12],onli:[0,5,6,8,10],opacu:[0,1,2,5,6,7,8,10,11,12],oper:[0,5,6,8],opt_ord:7,optim:[1,5,7,8],option:[1,8,10],order:[1,7,8],org:[2,8],origin:[2,8],original_step:8,other:[8,10],out:10,output:2,over:[5,12],overal:12,overridden:2,page:3,pair:[1,7,8],param:[0,6,12],paramet:[0,1,2,5,6,7,8,10,12],parameter:5,pass:[0,2,5,6,10],per:[0,2,3,5,8,11],per_sample_gradient_clip:5,perform:[1,2,8],persamplegradientclipp:5,pleas:2,pointer:8,popul:5,pre_step:5,prepar:5,previous:2,print:[1,2],prior:5,privaci:[3,5,9,10],privacy_analysi:7,privacy_engin:[5,8],privacyengin:[5,8],process:[1,5,10],propag:[6,11],proper:10,properli:10,provid:[0,5,6,10],put:5,python:[1,7],pytorch:[0,2,6,8],q_1:7,q_k:7,queri:[2,8],rais:[1,7,8],rand:12,randn:2,random:8,rang:[7,8,10],rate:[1,7],rather:8,ratio:[1,7,8],rdp:[1,7,8],rdp_account:7,real:5,recip:2,recommend:8,reduct:[0,5,6,8,10],refer:2,regist:2,register_backward_hook:[0,6],remov:[0,5,6,8,10],remove_hook:[0,6],renyi:7,repeat:5,repeatedli:8,replac:5,report:10,repres:[0,5,6,8],reset:10,respect:5,result:[1,10],right:8,rough:8,row:5,run:[2,7,8],same:7,sampl:[1,2,3,5,7,8,10,11,12],sample_s:[1,8],sample_stat:10,sampler:3,satisfi:1,save:[0,2,6],scalar:7,scale:5,script:[1,3],scriptmodul:2,search:3,second:[0,5,6],secur:8,secure_rng:8,see:[2,8,10],sensit:[1,5,7,8],sequenc:2,sequencebia:2,set:[0,5,6,8,10,12],set_global_summary_writ:10,set_on_batch_clip_func:5,sgd:[3,8,9],sgm:7,shape:[0,2,5,6,12],share:2,should:[2,5,8],show:8,shown:10,sigma:7,sigma_1:7,sigma_k:7,signific:8,silent:2,similar:10,sinc:2,singl:5,size:[1,2,5,8,12],slice:5,smaller:[5,8],some:10,sourc:[0,1,2,5,6,7,8,10,12],spent:8,stabl:8,standard:[1,7,8],stat:[3,5,12,13],stat_typ:10,state:[2,8],state_dict:2,statist:[5,10],stattyp:10,step:[1,5,7,8],steps_1:7,steps_k:7,stop:10,store:[5,8],str:[0,5,6,8,10,11,12],strategi:[5,10],string:12,subclass:2,suggest:[0,6],sum:[0,5,6,8,12],sum_over_all_but_batch_and_last_n:12,summary_writ:10,summarywrit:10,suppli:10,support:[0,2,6,10],supported_layers_grad_sampl:[6,11],suppos:7,sure:5,take:[0,2,5,6,8],target:[1,7,8],target_delta:8,tensor:[0,3,5,6,8,11,13],tensor_attribut:8,tensor_util:12,tensorboard:10,tensorflow:[1,7],tensorflow_privaci:[1,7],test:10,than:[1,5,8],thei:5,them:[0,2,5,6,10],therefor:8,thi:[0,1,2,5,6,7,8,10,11,12],thing:10,threshold:5,thu:[5,8],time:[5,7,8,10],togeth:[5,8],too:8,top:5,torch:[2,5,8,12],torchcsprng:8,total:5,track:[0,6],train:[1,8,10],tupl:[1,5,7,8,12],turn:8,tutori:2,two:[6,11],type:[0,1,2,5,6,7,8,10,11,12],under:[5,10],union:8,uniqu:10,unnecessarili:10,unsupport:8,updat:[7,10],usag:8,use:[8,10],used:[5,10],using:[0,6,10],usual:8,util:[3,5,10],val:10,valid:[8,10],valu:[0,2,5,6,7,8,10,11],valueerror:[1,7,8],vdim:2,vector:5,verbos:1,veri:[0,6],verifi:[0,6],view:10,virtual:8,virtual_step:8,visual:10,wai:[0,6],want:[8,10],weight:8,welcom:[0,6],were:5,what_is_state_dict:2,when:[1,5,7,8,12],whenev:8,where:[2,5,10,12],whether:[0,6],which:[0,1,5,6,7,8],wish:7,within:2,without:5,work:5,would:[7,8],wrapper:10,you:[1,5,8,10],your:[0,6,8,10],zero:12,zero_grad:8,zeros_lik:7},titles:["Autograd Grad Sample","Compute DP-SGD Privacy","DPMultiheadAttention","Opacus API Reference","DP Layers","Gradient Clipping","Per Sample Gradients","Privacy Analysis","Privacy Engine","Scripts","Stats","Layers Grad Samplers","Tensor Utils","Utils"],titleterms:{analysi:7,api:3,autograd:[0,6],clip:5,comput:1,dpmultiheadattent:2,engin:8,grad:[0,6,11],gradient:[5,6],indic:3,layer:[4,6,11],opacu:3,per:6,privaci:[1,7,8],refer:3,sampl:[0,6],sampler:[6,11],script:9,sgd:1,stat:10,tabl:3,tensor:12,util:[12,13]}})